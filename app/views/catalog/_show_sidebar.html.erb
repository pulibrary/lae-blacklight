<%#
Collapses Blacklight's app/views/catalog/_show_sidebar.html.erba and
app/views/catalog/_show_tools.html.erb into one, since we have less to show :-)
%>
<% ids = image_ids_labels_from_manifest_as_hash(@manifest) %>
<div class="panel panel-default show-tools">
  

  <div class="panel-heading centered"><a class="btn btn-link btn-osd-trigger"
  data-toggle="modal" data-target="#osd-full-modal"
    data-iiif-images="<%= ids.to_json %>"
    href="#">View Images (<%= @manifest.sequences[0].canvases.length %>)</a></div>
  <div class="panel-body">
    <div class="panel-image">
      <img width="230" src="<%= "#{@document['thumbnail_base']}/full/230,/0/default.png" %>" alt="preview" />
    </div>
    <ul class="nav">
      <li>
        <% # adds bookmark form %>
        <%= render_show_doc_actions @document %>
      </li>
      <% if respond_to? :librarian_view_catalog_path and @document.respond_to?(:to_marc) %>
        <li class="librarian_view">
        <%= link_to t('blacklight.tools.librarian_view'), librarian_view_catalog_path(@document), {:id => 'librarianLink', :data => {:ajax_modal => "trigger"}} %>
        </li>
      <% end %>
    </ul>
    <div class="modal osd-modal" id="osd-full-modal" tabindex="-1" role="dialog" aria-labelledby="<%= document_show_html_title %>" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="osdModalLabel">
                  <%= document_show_html_title %>
                </h4>
              </div>
              <div class="modal-body">
                <div class="viewer">
  <script>
    $('#osd-full-modal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget); // Button that triggered the modal
        var iiif_images = button.data('iiif-images'); // Extract info from 
        var modal = $(this);
        var viewer = modal.find('.viewer');
        viewer.iiifOsdViewer({
          data: [{
            iiifServer: 'http://libimages.princeton.edu/loris2',
            images: <%= raw ids.to_json %> }
          ]
        });
      });
    </script>
</div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
  </div>
</div>
  
<% unless @document.more_like_this.empty? %>
  <div class="panel panel-default">
    <div class="panel-heading">Similar Items</div>
    <div class="panel-body">
      <%= render collection: @document.more_like_this, partial: 'show_more_like_this', as: :document %>
    </div>
  </div>
<% end %>
